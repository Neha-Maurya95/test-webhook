# File: pipeline-templates/release.yaml
# This is a file elsewhere in the repository that represents 
# the release stage of our pipeline 

parameters:
- name: ApiTriggered # Required as first property.
  type: object
  default: ''
    

stages:
- stage: Deploy
  jobs:
  - job: Deploy
    pool:
      vmImage: windows-latest
    steps:
    - script: |
        echo "hello world"
      displayName: 'Command Line Script'
    - powershell: |
        Write-Host $testcondition
      displayName: Testvariable

#  - job: manual_approval
#    displayName: "Manual Approval"
#    dependsOn: Deploy
#    pool: server 
#    steps: 
#    - task: ManualIntervention@8
#      inputs:
#        emailRecipients: 'neha.maurya@netsmartz.com'
#      condition: and(succeeded(), ne(variables['testcondition'], 'True'))

    - task: ManualValidation@0
      timeoutInMinutes: 1440 # task times out in 1 day
      inputs:
        notifyUsers: |
          neha.maurya@netsmartz.com
        instructions: 'Please validate the build configuration and resume'
        onTimeout: 'resume'
      condition: and(succeeded(), ne(variables['testcondition'], 'True'))
